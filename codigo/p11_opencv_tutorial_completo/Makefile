# Makefile para Tutorial Completo de OpenCV
# Procesamiento Digital de ImÃ¡genes

TARGET = tutorial
CXX = g++
CXXFLAGS = -std=c++17 -Wall -Wextra

# Ruta donde estÃ¡n los archivos .h de OpenCV (headers/includes)
CPPFLAGS = -I"$(HOME)/Documentos/universidad/universidad 7mo/vision por computador/opencv-dev/install/include/opencv4"

# Ruta donde estÃ¡n las bibliotecas compiladas de OpenCV (.so o .a)
LDFLAGS = -L"$(HOME)/Documentos/universidad/universidad 7mo/vision por computador/opencv-dev/install/lib"

# Bibliotecas que se enlazarÃ¡n al programa (OpenCV y GStreamer)
LDLIBS = $(shell pkg-config --libs-only-l opencv4) \
         $(shell pkg-config --libs gstreamer-1.0 gstreamer-base-1.0 gstreamer-video-1.0 gstreamer-app-1.0)

# Archivo fuente
SRC = main.cpp

# Targets
.PHONY: all clean help run

# Regla principal: construir el ejecutable
all: $(TARGET)
	@echo ""
	@echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
	@echo "â•‘  âœ“ Tutorial compilado exitosamente                                â•‘"
	@echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo ""
	@echo "ğŸ“š TUTORIAL COMPLETO DE PROCESAMIENTO DIGITAL DE IMÃGENES"
	@echo ""
	@echo "Uso:"
	@echo "  ./$(TARGET) <imagen.jpg>"
	@echo ""
	@echo "Ejemplos:"
	@echo "  ./$(TARGET) test.jpg"
	@echo "  ./$(TARGET) ~/ImÃ¡genes/foto.png"
	@echo ""
	@echo "Contenido del tutorial (13 secciones):"
	@echo "  1.  Carga y verificaciÃ³n de imÃ¡genes"
	@echo "  2.  InformaciÃ³n y propiedades"
	@echo "  3.  Espacios de color (BGR, HSV, LAB, GRAY)"
	@echo "  4.  Operaciones bÃ¡sicas (brillo, contraste, rotaciÃ³n)"
	@echo "  5.  Filtrado y suavizado"
	@echo "  6.  DetecciÃ³n de bordes"
	@echo "  7.  Transformaciones morfolÃ³gicas"
	@echo "  8.  UmbralizaciÃ³n y binarizaciÃ³n"
	@echo "  9.  Histogramas y ecualizaciÃ³n"
	@echo "  10. DetecciÃ³n de contornos"
	@echo "  11. Operaciones lÃ³gicas"
	@echo "  12. SegmentaciÃ³n por color"
	@echo "  13. ManipulaciÃ³n directa de pÃ­xeles (12 ejercicios)"
	@echo ""

# CÃ³mo compilar el programa desde main.cpp
$(TARGET): $(SRC)
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo "  Compilando Tutorial de OpenCV..."
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	$(CXX) $(CXXFLAGS) $(CPPFLAGS) $(SRC) -o $(TARGET) $(LDFLAGS) $(LDLIBS)

# Regla para limpiar archivos generados
clean:
	@echo "Limpiando archivos generados..."
	rm -f $(TARGET)
	@echo "âœ“ Limpieza completada"

# Ayuda
help:
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo "  Makefile - Tutorial Completo de PDI con OpenCV"
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo ""
	@echo "Comandos disponibles:"
	@echo "  make          - Compila el tutorial"
	@echo "  make clean    - Elimina el ejecutable"
	@echo "  make help     - Muestra esta ayuda"
	@echo "  make run IMG=<archivo> - Compila y ejecuta con una imagen"
	@echo ""
	@echo "Uso del tutorial:"
	@echo "  ./$(TARGET) imagen.jpg"
	@echo ""
	@echo "Ejemplo con make run:"
	@echo "  make run IMG=test.jpg"
	@echo ""
	@echo "Secciones del tutorial:"
	@echo "  â€¢ 13 secciones principales"
	@echo "  â€¢ MÃ¡s de 50 tÃ©cnicas de PDI"
	@echo "  â€¢ 12 ejercicios de manipulaciÃ³n de pÃ­xeles"
	@echo "  â€¢ Completamente documentado"
	@echo ""
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

# Compilar y ejecutar (requiere especificar IMG=archivo)
run: $(TARGET)
	@if [ -z "$(IMG)" ]; then \
		echo "Error: Debes especificar una imagen con IMG=archivo"; \
		echo "Ejemplo: make run IMG=test.jpg"; \
		exit 1; \
	fi
	@if [ ! -f "$(IMG)" ]; then \
		echo "Error: La imagen '$(IMG)' no existe"; \
		exit 1; \
	fi
	@echo ""
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo "  Ejecutando tutorial con: $(IMG)"
	@echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo ""
	./$(TARGET) $(IMG)

# Verificar dependencias
check:
	@echo "Verificando dependencias..."
	@echo ""
	@echo -n "OpenCV 4: "
	@pkg-config --exists opencv4 && echo "âœ“ Instalado" || echo "âœ— No encontrado"
	@pkg-config --exists opencv4 && echo "  VersiÃ³n: $$(pkg-config --modversion opencv4)"
	@echo ""
	@echo -n "GStreamer: "
	@pkg-config --exists gstreamer-1.0 && echo "âœ“ Instalado" || echo "âœ— No encontrado"
	@pkg-config --exists gstreamer-1.0 && echo "  VersiÃ³n: $$(pkg-config --modversion gstreamer-1.0)"
	@echo ""
	@echo -n "Compilador C++: "
	@which $(CXX) > /dev/null && echo "âœ“ $(CXX) disponible" || echo "âœ— No encontrado"
	@which $(CXX) > /dev/null && echo "  VersiÃ³n: $$($(CXX) --version | head -1)"
	@echo ""
